# Видеопоиск

Приложение на Streamlit для поиска информации в видео-лекциях

## Структура проекта

```
.
├── data/                      # Данные проекта
│   ├── optimized_program/     # Оптимизированные программы для QA
│   ├── queries.csv            # Датасет для получения лучшего промпта
│   └── transcriptions/        # Транскрипции видео
├── infra/                     # Docker конфигурации
├── model/                     # Модели
├── pages/                     # Страницы Streamlit
│   ├── video_page.py          # Страница для работы с видео
│   └── json_page.py           # Страница для работы с JSON
├── src/                       # Исходный код
│   ├── audio_processor.py     # Обработка аудио
│   ├── QA.py                  # Вопросно-ответная система
│   ├── retrieval.py           # Поиск релевантных фрагментов
│   ├── stt_model.py           # Модель распознавания речи
│   └── video_processor.py     # Обработка видео
├── .env.example               # Пример конфигурации
├── ctc_model_config.yaml      # Конфигурация модели STT
├── ctc_model_weights.ckpt     # Веса модели STT
├── main.py                    # Главная страница
├── prompts_train.ipynb        # Код для получения лучшего промпта
└── menu.py                    # Навигационное меню
```

## Настройка проекта

1. Клонируйте репозиторий:
```bash
git clone git@github.com:ndromanenko/video_searching.git
```

2. Создайте и активируйте виртуальное окружение:
```bash
uv sync
```

3. Настройте переменные окружения:
```bash
cp .env.example .env

vim .env
```

Отредактируйте файл `.env`, добавив необходимые API ключи:
- `OPENAI_KEY` - ключ API OpenAI
- `LANGSMITH_API_KEY` - ключ API LangSmith (опционально)
- `LANGSMITH_TRACING` - включение трассировки LangChain (опционально)
- `LANGSMITH_PROJECT` - название проекта в LangSmith (опционально)
- `LANGSMITH_ENDPOINT` - кастомный endpoint LangSmith (если используется)

5. Скачайте модель STT и доп. файлы к ней

[Скачать с Яндекс.Диска](https://disk.yandex.ru/d/0hQJBCsUIDlVJQ)  

Поместите в корневую директорию файлы:
```bash
# Скачайте файлы модели и поместите их в корневую директорию:
# - ctc_model_config.yaml
# - ctc_model_weights.ckpt
# - model
```

## Запуск приложения

1. Запустите приложение:
```bash
make run
``` 
для локальго запуска streamlit

```bash
make docker
``` 
для поднятия docker-котнейнера

2. Откройте браузер и перейдите по адресу: http://localhost:8501

## Использование

Приложение предоставляет два режима работы:

1. **Запросы по видео**
   - Загрузите видео-файл в формате MP4
   - Дождитесь обработки (около 5 минут)
   - Задавайте вопросы по содержанию видео
   - Получайте временные метки с релевантными фрагментами

2. **Запросы по файлу с транскрипцией**
   - Загрузите JSON файл с транскрипцией
   - Сразу начинайте задавать вопросы
   - Получайте временные метки с релевантными фрагментами